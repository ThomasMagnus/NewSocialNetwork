document.addEventListener("DOMContentLoaded",(()=>{"use strict";const e=document.querySelector(".userCover"),t=document.querySelector(".userCover__edit_wrapper"),o=document.querySelectorAll(".fa-ellipsis-v"),n=document.querySelectorAll(".ellipsis__list"),c=document.querySelectorAll(".edit-post"),l=document.querySelectorAll(".cancel__wrapper"),r=document.querySelector(".content__btn"),s=document.querySelector(".content__form"),i=document.querySelectorAll(".content__edit-btn"),a=document.querySelectorAll(".ellipsis__del"),d=document.querySelector(".userCover__edit"),u=document.querySelector(".errorlist");let _,m,p,y;const v=async(e,t,o)=>await fetch(t,{method:"POST",body:e,headers:o,credentials:"include"}),S=e=>{_=e.target,m=_.closest(".content__item"),p=m.querySelector(".content__text-edit"),y=m.querySelector(".content__panel")},f=e=>{let t=h();S(e);const o=_.parentElement.querySelector(".ellipsis__list");t&&n[t]===o?o.classList.remove("active_disp"):o.classList.add("active_disp")},h=()=>{let e;return n.forEach(((t,o)=>{t.classList.contains("active_disp")&&(t.classList.remove("active_disp"),e=o)})),e},q=e=>{S(e);const t=m.querySelector(".content__text"),o=document.createElement("form"),n=document.createElement("textarea"),c=m.querySelector(".content__text-edit"),l=m.querySelector(".content__panel");h(),o.classList.add("edit_post_form"),t.style.display="none",n.classList.add("edit__content"),n.setAttribute("data-id",t.getAttribute("data-id")),n.setAttribute("name","editPost"),o.append(n),n.value=t.textContent,c.before(o),l.style.display="flex"},g=e=>{S(e);const t=m.querySelector(".edit__content"),o=m.querySelector(".content__text");t.remove(),y.style.display="none",o.style.display="block"},L=()=>{let e=document.querySelector(".edit_post_form").querySelector(".edit__content");const t={editPost:e.value,id:e.getAttribute("data-id")},o=JSON.stringify(t);v(o,"http://localhost:8000/createPost/edit/",E()).then((e=>console.log(e))).finally((()=>{document.location.reload()}))},E=()=>{const e=new Headers;return e.append("X-CSRFToken",(e=>{let t=null;if(document.cookie&&""!==document.cookie){const o=document.cookie.split(";");for(let n=0;n<=o.length-1;n++)o[n].substring(0,e.length+1)===e+"="&&(t=decodeURIComponent(o[n].substring(e.length+1)))}return t})("csrftoken")),e};e.addEventListener("mouseenter",(()=>{t.classList.toggle("edit__active")})),e.addEventListener("mouseleave",(()=>{t.classList.remove("edit__active")})),o.forEach((e=>e.addEventListener("click",f))),c.forEach((e=>e.addEventListener("click",q))),l.forEach((e=>e.addEventListener("click",g))),i.forEach((e=>e.addEventListener("click",L))),r.addEventListener("click",(e=>(e=>{e.preventDefault();const t=new FormData(s);""!==document.querySelector("#comment").value&&v(t,"http://localhost:8000/createPost/",E()).then((e=>console.log(e))).finally((()=>{s.reset(),document.location.reload()}))})(e))),a.forEach((e=>e.addEventListener("click",(e=>(e=>{const t=e.target,o=t.closest(".content__item").querySelector(".content__text");t.closest(".ellipsis__list ").classList.remove("active_disp");const n={postId:o.getAttribute("data-id")},c=JSON.stringify(n);v(c,"http://localhost:8000/createPost/deletePost/",E()).then((e=>console.log(e))).finally((()=>document.location.reload()))})(e))))),d.addEventListener("change",(e=>{d.files[0];const t=e.target,o=new FormData;o.append("file",t.files[0]);const n={"Content-Type":"multipart/form-data",...E()};v(o,"http://localhost:8000/users/changeCover/photo",n).then((e=>console.log(e)))})),u.style.display="none"}));