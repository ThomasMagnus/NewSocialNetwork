document.addEventListener("DOMContentLoaded",(()=>{"use strict";const e=document.querySelector(".userCover"),t=document.querySelector(".userCover__edit_wrapper"),o=document.querySelectorAll(".fa-ellipsis-v"),n=document.querySelectorAll(".ellipsis__list"),c=document.querySelectorAll(".edit-post"),l=document.querySelectorAll(".cancel__wrapper"),r=document.querySelector(".content__btn"),s=document.querySelector(".content__form"),i=document.querySelectorAll(".content__edit-btn"),d=document.querySelectorAll(".ellipsis__del"),a=document.querySelector(".userCover__edit"),u=document.querySelector(".errorlist"),_=document.querySelector(".cover__form");let m,y,p,v;const S=async(e,t,o)=>await fetch(t,{method:"POST",body:e,headers:o,credentials:"include"}),h=e=>{m=e.target,y=m.closest(".content__item"),p=y.querySelector(".content__text-edit"),v=y.querySelector(".content__panel")},q=e=>{let t=f();h(e);const o=m.parentElement.querySelector(".ellipsis__list");t&&n[t]===o?o.classList.remove("active_disp"):o.classList.add("active_disp")},f=()=>{let e;return n.forEach(((t,o)=>{t.classList.contains("active_disp")&&(t.classList.remove("active_disp"),e=o)})),e},g=e=>{h(e);const t=y.querySelector(".content__text"),o=document.createElement("form"),n=document.createElement("textarea"),c=y.querySelector(".content__text-edit"),l=y.querySelector(".content__panel");f(),o.classList.add("edit_post_form"),t.style.display="none",n.classList.add("edit__content"),n.setAttribute("data-id",t.getAttribute("data-id")),n.setAttribute("name","editPost"),o.append(n),n.value=t.textContent,c.before(o),l.style.display="flex"},L=e=>{h(e);const t=y.querySelector(".edit__content"),o=y.querySelector(".content__text");t.remove(),v.style.display="none",o.style.display="block"},E=()=>{let e=document.querySelector(".edit_post_form").querySelector(".edit__content");const t={editPost:e.value,id:e.getAttribute("data-id")},o=JSON.stringify(t);S(o,"http://localhost:8000/createPost/edit/",k()).then((e=>console.log(e))).finally((()=>{document.location.reload()}))},k=()=>{const e=new Headers;return e.append("X-CSRFToken",(e=>{let t=null;if(document.cookie&&""!==document.cookie){const o=document.cookie.split(";");for(let n=0;n<=o.length-1;n++)o[n].substring(0,e.length+1)===e+"="&&(t=decodeURIComponent(o[n].substring(e.length+1)))}return t})("csrftoken")),e};e.addEventListener("mouseenter",(()=>{t.classList.toggle("edit__active")})),e.addEventListener("mouseleave",(()=>{t.classList.remove("edit__active")})),o.forEach((e=>e.addEventListener("click",q))),c.forEach((e=>e.addEventListener("click",g))),l.forEach((e=>e.addEventListener("click",L))),i.forEach((e=>e.addEventListener("click",E))),r.addEventListener("click",(e=>(e=>{e.preventDefault();const t=new FormData(s);""!==document.querySelector("#comment").value&&S(t,"http://localhost:8000/createPost/",k()).then((e=>console.log(e))).finally((()=>{s.reset(),document.location.reload()}))})(e))),d.forEach((e=>e.addEventListener("click",(e=>(e=>{const t=e.target,o=t.closest(".content__item").querySelector(".content__text");t.closest(".ellipsis__list ").classList.remove("active_disp");const n={postId:o.getAttribute("data-id")},c=JSON.stringify(n);S(c,"http://localhost:8000/createPost/deletePost/",k()).then((e=>console.log(e))).finally((()=>document.location.reload()))})(e))))),a.addEventListener("change",(()=>{const e=new FormData(_),t={"X-CSRFToken":k()},o=document.location.pathname.match(/\d/g).join("");e.append("user_id",o),S(e,"http://localhost:8000/users/changeCover/photo",t).then((e=>{console.log(e),document.location.reload()}))})),u.style.display="none"}));